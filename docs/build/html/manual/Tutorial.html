<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Usage Example" href="../example.html" /><link rel="prev" title="Jupyter Notebook Version for calculating Pacific Impact on Sahelian Rain Fall" href="Pacific_Impact_Sahelian_Rainfall.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Step by step Tutorial - Spy4Cast &#34;1.0.0&#34; documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css?v=995e94df" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.min.css?v=21c0b90a" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/style.css?v=8bdc53c2" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Spy4Cast "1.0.0" documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Spy4Cast "1.0.0" documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mca.html">MCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crossvalidation.html">Crossvalidation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../validation.html">Validation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="manual.html">Spy4Cast Manual</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Spy4Cast Manual</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Climatology_Anomaly_EquatorialAtlantic.html">Example to Open, Slice and Plot Anomaly and Climatology Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="EquatorialAtlantic_Impact_Nino.html">Jupyter Notebook Version for calculating Equatorial Impact of the Niño</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pacific_Impact_European_SLP.html">Calculating Pacific Impact on Sahelian Rain Fall</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pacific_Impact_Sahelian_Rainfall.html">Jupyter Notebook Version for calculating Pacific Impact on Sahelian Rain Fall</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Step by step Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example.html">Usage Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting.html">Plotting</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Comparission with Xarray</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../variables/variables.html">Output Variables</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Output Variables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../variables/dataset.html">Dataset Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variables/preprocess.html">Preprocess Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variables/mca.html">MCA Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variables/crossvalidation.html">Crossvalidation Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variables/validation.html">Validation Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variables/anom.html">Anom Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variables/clim.html">Clim Variables</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../toctrees/api-reference.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../toctrees/api-reference-src/spy4cast.html">Spy4cast</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Spy4cast</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.spy4cast.index_regression.html">index_regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.spy4cast.MCA.html">MCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.spy4cast.Preprocess.html">Preprocess</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.spy4cast.Crossvalidation.html">Crossvalidation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.spy4cast.Validation.html">Validation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../toctrees/api-reference-src/dataset.html">Dataset</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Dataset</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.dataset.Dataset.html">Dataset</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../toctrees/api-reference-src/meteo.html">Meteo</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Meteo</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.meteo.PlotType.html">PlotType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.meteo.Anom.html">Anom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.meteo.Clim.html">Clim</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../toctrees/api-reference-src/stypes.html">Stypes</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Stypes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.stypes.Region.html">Region</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.stypes.Month.html">Month</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.stypes.Color.html">Color</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.stypes.T_FORMAT.html">T_FORMAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.stypes.TimeStamp.html">TimeStamp</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../toctrees/api-reference-src/errors.html">Errors</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Errors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.Spy4CastError.html">Spy4CastError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.PlotCreationError.html">PlotCreationError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.VariableSelectionError.html">VariableSelectionError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.TimeBoundsSelectionError.html">TimeBoundsSelectionError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.PlotShowingError.html">PlotShowingError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.DataSavingError.html">DataSavingError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.SelectedYearError.html">SelectedYearError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.DatasetNotFoundError.html">DatasetNotFoundError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.DatasetError.html">DatasetError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/spy4cast.errors.PlotDataError.html">PlotDataError</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/manual/Tutorial.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Step-by-step-Tutorial">
<h1>Step by step Tutorial<a class="headerlink" href="#Step-by-step-Tutorial" title="Link to this heading">¶</a></h1>
<p>In this tutorial we will go throught the entire implementation of spy4cast MCA methodology</p>
<p>On the first section we will do everything using xarray and on the second one we will introduce the abstractions that spy4cast implements to enhace productivity</p>
<p>Using Xarray</p>
<ul class="simple">
<li><p>Configuration</p></li>
<li><p>Preprocessing</p></li>
<li><p>MCA</p></li>
<li><p>Plot results</p></li>
</ul>
<p>Using Spy4Cast</p>
<ul class="simple">
<li><p>Configuration</p></li>
<li><p>Preprocessing</p></li>
<li><p>MCA</p></li>
<li><p>Plot results</p></li>
<li><p>Crossvalidation</p></li>
</ul>
<section id="Using-xarray">
<h2>Using xarray<a class="headerlink" href="#Using-xarray" title="Link to this heading">¶</a></h2>
<p>In this case of study we will go through the relation between sea surface temperature in the Atlantic ocean and the clorophyl concentration in the shouth coast of the Iberian Peninsula. It is the code used to replicate the results from <a class="reference external" href="https://doi.org/10.3389/fmars.2022.931832">Lopez-Parages, Jorge, et al. 2022</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span><span class="p">,</span> <span class="n">sparse</span><span class="p">,</span> <span class="n">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">gridspec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/pabloduran/opt/anaconda3/envs/Spy4Cast/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version &gt;=1.16.5 and &lt;1.23.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f&#34;A NumPy version &gt;={np_minversion} and &lt;{np_maxversion}&#34;
</pre></div></div>
</div>
<section id="1.-Configuration">
<h3>1. Configuration<a class="headerlink" href="#1.-Configuration" title="Link to this heading">¶</a></h3>
<p>Load the data:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATASET_DIR</span> <span class="o">=</span> <span class="s2">&quot;datasets&quot;</span>

<span class="n">PREDICTOR_NAME</span> <span class="o">=</span> <span class="s2">&quot;HadISST_sst_chopped.nc&quot;</span>
<span class="n">PREDICTAND_NAME</span> <span class="o">=</span> <span class="s2">&quot;chl_1km_monthly_Sep1997_Dec2020_sliced.nc&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATASET_DIR</span><span class="p">,</span> <span class="n">PREDICTOR_NAME</span><span class="p">))</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">sst_ds</span><span class="p">[</span><span class="s2">&quot;sst&quot;</span><span class="p">]</span>
<span class="n">chl_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATASET_DIR</span><span class="p">,</span> <span class="n">PREDICTAND_NAME</span><span class="p">))</span>
<span class="n">chl</span> <span class="o">=</span> <span class="n">chl_ds</span><span class="p">[</span><span class="s2">&quot;CHL&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Slice the data:</p>
<p>Predictor Region: Atlantic Ocean (lat = from 5º to 25º, lon = from -75º to -20º) Predictor Time: 1997 -&gt; 2019 Predictor Season: AUG, SEP</p>
<p>Predictand Region: Southearn Coast of Iberian Peninsula (lat = from 36º to 37º, lon = from -5.3º to -2º) Predictand Time: 1998 -&gt; 2020 Predictand Season: MAR, APR</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;sst&#x27; (time: 605, latitude: 180, longitude: 360)&gt; Size: 157MB
[39204000 values with dtype=float32]
Coordinates:
  * time       (time) datetime64[ns] 5kB 1970-01-16T12:00:00 ... 2020-05-16T1...
  * latitude   (latitude) float32 720B 89.5 88.5 87.5 86.5 ... -87.5 -88.5 -89.5
  * longitude  (longitude) float32 1kB -179.5 -178.5 -177.5 ... 178.5 179.5
Attributes:
    standard_name:  sea_surface_temperature
    long_name:      sst
    units:          C
    cell_methods:   time: lat: lon: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'sst'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 605</li><li><span class='xr-has-index'>latitude</span>: 180</li><li><span class='xr-has-index'>longitude</span>: 360</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-0d934939-e3c0-4d59-be83-2a34a48606ab' class='xr-array-in' type='checkbox' checked><label for='section-0d934939-e3c0-4d59-be83-2a34a48606ab' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[39204000 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-33482009-972f-40d3-a3c4-e4504ab8aa06' class='xr-section-summary-in' type='checkbox'  checked><label for='section-33482009-972f-40d3-a3c4-e4504ab8aa06' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1970-01-16T12:00:00 ... 2020-05-...</div><input id='attrs-f942b256-ce34-4e24-a9c8-e5b56ac0e51c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f942b256-ce34-4e24-a9c8-e5b56ac0e51c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f5dbd77-9ca7-46ef-b7d9-4ffdc4a68cdf' class='xr-var-data-in' type='checkbox'><label for='data-1f5dbd77-9ca7-46ef-b7d9-4ffdc4a68cdf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1970-01-16T12:00:00.000000000&#x27;, &#x27;1970-02-15T00:00:00.000000000&#x27;,
       &#x27;1970-03-16T12:00:00.000000000&#x27;, ..., &#x27;2020-03-16T12:00:00.000000000&#x27;,
       &#x27;2020-04-16T12:00:00.000000000&#x27;, &#x27;2020-05-16T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>89.5 88.5 87.5 ... -88.5 -89.5</div><input id='attrs-4f318113-1370-41b4-a8a4-4ec0d792558c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4f318113-1370-41b4-a8a4-4ec0d792558c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7ad913eb-2c4d-491a-9e59-eaab32869336' class='xr-var-data-in' type='checkbox'><label for='data-7ad913eb-2c4d-491a-9e59-eaab32869336' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 89.5,  88.5,  87.5,  86.5,  85.5,  84.5,  83.5,  82.5,  81.5,  80.5,
        79.5,  78.5,  77.5,  76.5,  75.5,  74.5,  73.5,  72.5,  71.5,  70.5,
        69.5,  68.5,  67.5,  66.5,  65.5,  64.5,  63.5,  62.5,  61.5,  60.5,
        59.5,  58.5,  57.5,  56.5,  55.5,  54.5,  53.5,  52.5,  51.5,  50.5,
        49.5,  48.5,  47.5,  46.5,  45.5,  44.5,  43.5,  42.5,  41.5,  40.5,
        39.5,  38.5,  37.5,  36.5,  35.5,  34.5,  33.5,  32.5,  31.5,  30.5,
        29.5,  28.5,  27.5,  26.5,  25.5,  24.5,  23.5,  22.5,  21.5,  20.5,
        19.5,  18.5,  17.5,  16.5,  15.5,  14.5,  13.5,  12.5,  11.5,  10.5,
         9.5,   8.5,   7.5,   6.5,   5.5,   4.5,   3.5,   2.5,   1.5,   0.5,
        -0.5,  -1.5,  -2.5,  -3.5,  -4.5,  -5.5,  -6.5,  -7.5,  -8.5,  -9.5,
       -10.5, -11.5, -12.5, -13.5, -14.5, -15.5, -16.5, -17.5, -18.5, -19.5,
       -20.5, -21.5, -22.5, -23.5, -24.5, -25.5, -26.5, -27.5, -28.5, -29.5,
       -30.5, -31.5, -32.5, -33.5, -34.5, -35.5, -36.5, -37.5, -38.5, -39.5,
       -40.5, -41.5, -42.5, -43.5, -44.5, -45.5, -46.5, -47.5, -48.5, -49.5,
       -50.5, -51.5, -52.5, -53.5, -54.5, -55.5, -56.5, -57.5, -58.5, -59.5,
       -60.5, -61.5, -62.5, -63.5, -64.5, -65.5, -66.5, -67.5, -68.5, -69.5,
       -70.5, -71.5, -72.5, -73.5, -74.5, -75.5, -76.5, -77.5, -78.5, -79.5,
       -80.5, -81.5, -82.5, -83.5, -84.5, -85.5, -86.5, -87.5, -88.5, -89.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-179.5 -178.5 ... 178.5 179.5</div><input id='attrs-347ec2b8-09f3-45d0-8c23-a6851fa8934c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-347ec2b8-09f3-45d0-8c23-a6851fa8934c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7af97376-42bd-43a9-88a4-f4e12a9526e6' class='xr-var-data-in' type='checkbox'><label for='data-7af97376-42bd-43a9-88a4-f4e12a9526e6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-179.5, -178.5, -177.5, ...,  177.5,  178.5,  179.5], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f70a5188-f015-471f-933c-e9e9fb23eaa5' class='xr-section-summary-in' type='checkbox'  ><label for='section-f70a5188-f015-471f-933c-e9e9fb23eaa5' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-31a17c47-c528-4eab-8233-24fcf6fd0799' class='xr-index-data-in' type='checkbox'/><label for='index-31a17c47-c528-4eab-8233-24fcf6fd0799' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1970-01-16 12:00:00&#x27;, &#x27;1970-02-15 00:00:00&#x27;,
               &#x27;1970-03-16 12:00:00&#x27;, &#x27;1970-04-16 00:00:00&#x27;,
               &#x27;1970-05-16 12:00:00&#x27;, &#x27;1970-06-16 00:00:00&#x27;,
               &#x27;1970-07-16 12:00:00&#x27;, &#x27;1970-08-16 12:00:00&#x27;,
               &#x27;1970-09-16 00:00:00&#x27;, &#x27;1970-10-16 12:00:00&#x27;,
               ...
               &#x27;2019-08-16 12:00:00&#x27;, &#x27;2019-09-16 12:00:00&#x27;,
               &#x27;2019-10-16 12:00:00&#x27;, &#x27;2019-11-16 12:00:00&#x27;,
               &#x27;2019-12-16 12:00:00&#x27;, &#x27;2020-01-16 12:00:00&#x27;,
               &#x27;2020-02-16 12:00:00&#x27;, &#x27;2020-03-16 12:00:00&#x27;,
               &#x27;2020-04-16 12:00:00&#x27;, &#x27;2020-05-16 12:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=605, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5999c5ce-6211-498f-925c-644784f55742' class='xr-index-data-in' type='checkbox'/><label for='index-5999c5ce-6211-498f-925c-644784f55742' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 89.5,  88.5,  87.5,  86.5,  85.5,  84.5,  83.5,  82.5,  81.5,  80.5,
       ...
       -80.5, -81.5, -82.5, -83.5, -84.5, -85.5, -86.5, -87.5, -88.5, -89.5],
      dtype=&#x27;float32&#x27;, name=&#x27;latitude&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7ed2209d-80cd-467b-b571-b67458d0b40b' class='xr-index-data-in' type='checkbox'/><label for='index-7ed2209d-80cd-467b-b571-b67458d0b40b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-179.5, -178.5, -177.5, -176.5, -175.5, -174.5, -173.5, -172.5, -171.5,
       -170.5,
       ...
        170.5,  171.5,  172.5,  173.5,  174.5,  175.5,  176.5,  177.5,  178.5,
        179.5],
      dtype=&#x27;float32&#x27;, name=&#x27;longitude&#x27;, length=360))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ee10ccb1-cb8b-43fd-87e9-edc0f2cea77b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ee10ccb1-cb8b-43fd-87e9-edc0f2cea77b' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_surface_temperature</dd><dt><span>long_name :</span></dt><dd>sst</dd><dt><span>units :</span></dt><dd>C</dd><dt><span>cell_methods :</span></dt><dd>time: lat: lon: mean</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: lat dimension in y_ds is from high to low</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">sst</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">),</span> <span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">sst</span><span class="p">[(</span><span class="n">sst</span><span class="p">[</span><span class="s2">&quot;time.year&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1997</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s2">&quot;time.year&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2019</span><span class="p">)]</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">sst</span><span class="p">[(</span><span class="n">sst</span><span class="p">[</span><span class="s2">&quot;time.month&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s2">&quot;time.month&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;sst&#x27; (time: 46, latitude: 20, longitude: 55)&gt; Size: 202kB
[50600 values with dtype=float32]
Coordinates:
  * time       (time) datetime64[ns] 368B 1997-08-16T12:00:00 ... 2019-09-16T...
  * latitude   (latitude) float32 80B 24.5 23.5 22.5 21.5 ... 8.5 7.5 6.5 5.5
  * longitude  (longitude) float32 220B -74.5 -73.5 -72.5 ... -22.5 -21.5 -20.5
Attributes:
    standard_name:  sea_surface_temperature
    long_name:      sst
    units:          C
    cell_methods:   time: lat: lon: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'sst'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 46</li><li><span class='xr-has-index'>latitude</span>: 20</li><li><span class='xr-has-index'>longitude</span>: 55</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-f8f743f6-ea03-4a77-8dd7-98c6efe05897' class='xr-array-in' type='checkbox' checked><label for='section-f8f743f6-ea03-4a77-8dd7-98c6efe05897' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[50600 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-ecd5feb1-e6ef-4451-b765-d309aa48669d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ecd5feb1-e6ef-4451-b765-d309aa48669d' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1997-08-16T12:00:00 ... 2019-09-...</div><input id='attrs-a3d22c4a-6f2d-44dc-a536-8dc8152de556' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a3d22c4a-6f2d-44dc-a536-8dc8152de556' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8744e28b-99cc-4754-9d4e-faf370f37065' class='xr-var-data-in' type='checkbox'><label for='data-8744e28b-99cc-4754-9d4e-faf370f37065' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1997-08-16T12:00:00.000000000&#x27;, &#x27;1997-09-16T00:00:00.000000000&#x27;,
       &#x27;1998-08-16T12:00:00.000000000&#x27;, &#x27;1998-09-16T00:00:00.000000000&#x27;,
       &#x27;1999-08-16T12:00:00.000000000&#x27;, &#x27;1999-09-16T00:00:00.000000000&#x27;,
       &#x27;2000-08-16T12:00:00.000000000&#x27;, &#x27;2000-09-16T00:00:00.000000000&#x27;,
       &#x27;2001-08-16T12:00:00.000000000&#x27;, &#x27;2001-09-16T00:00:00.000000000&#x27;,
       &#x27;2002-08-16T12:00:00.000000000&#x27;, &#x27;2002-09-16T00:00:00.000000000&#x27;,
       &#x27;2003-08-16T12:00:00.000000000&#x27;, &#x27;2003-09-16T00:00:00.000000000&#x27;,
       &#x27;2004-08-16T12:00:00.000000000&#x27;, &#x27;2004-09-16T00:00:00.000000000&#x27;,
       &#x27;2005-08-16T12:00:00.000000000&#x27;, &#x27;2005-09-16T00:00:00.000000000&#x27;,
       &#x27;2006-08-16T12:00:00.000000000&#x27;, &#x27;2006-09-16T00:00:00.000000000&#x27;,
       &#x27;2007-08-16T12:00:00.000000000&#x27;, &#x27;2007-09-16T00:00:00.000000000&#x27;,
       &#x27;2008-08-16T12:00:00.000000000&#x27;, &#x27;2008-09-16T12:00:00.000000000&#x27;,
       &#x27;2009-08-16T12:00:00.000000000&#x27;, &#x27;2009-09-16T12:00:00.000000000&#x27;,
       &#x27;2010-08-16T12:00:00.000000000&#x27;, &#x27;2010-09-16T12:00:00.000000000&#x27;,
       &#x27;2011-08-16T12:00:00.000000000&#x27;, &#x27;2011-09-16T12:00:00.000000000&#x27;,
       &#x27;2012-08-16T12:00:00.000000000&#x27;, &#x27;2012-09-16T12:00:00.000000000&#x27;,
       &#x27;2013-08-16T12:00:00.000000000&#x27;, &#x27;2013-09-16T12:00:00.000000000&#x27;,
       &#x27;2014-08-16T12:00:00.000000000&#x27;, &#x27;2014-09-16T12:00:00.000000000&#x27;,
       &#x27;2015-08-16T12:00:00.000000000&#x27;, &#x27;2015-09-16T12:00:00.000000000&#x27;,
       &#x27;2016-08-16T12:00:00.000000000&#x27;, &#x27;2016-09-16T12:00:00.000000000&#x27;,
       &#x27;2017-08-16T12:00:00.000000000&#x27;, &#x27;2017-09-16T12:00:00.000000000&#x27;,
       &#x27;2018-08-16T12:00:00.000000000&#x27;, &#x27;2018-09-16T12:00:00.000000000&#x27;,
       &#x27;2019-08-16T12:00:00.000000000&#x27;, &#x27;2019-09-16T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>24.5 23.5 22.5 21.5 ... 7.5 6.5 5.5</div><input id='attrs-ccf6c856-dde0-4f18-809b-7096908c1b85' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ccf6c856-dde0-4f18-809b-7096908c1b85' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62063254-3ab7-4f9c-a393-9e70d181a428' class='xr-var-data-in' type='checkbox'><label for='data-62063254-3ab7-4f9c-a393-9e70d181a428' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([24.5, 23.5, 22.5, 21.5, 20.5, 19.5, 18.5, 17.5, 16.5, 15.5, 14.5, 13.5,
       12.5, 11.5, 10.5,  9.5,  8.5,  7.5,  6.5,  5.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-74.5 -73.5 -72.5 ... -21.5 -20.5</div><input id='attrs-60d18d03-e72e-418b-bd04-fbeef53bd26a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-60d18d03-e72e-418b-bd04-fbeef53bd26a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de85ac07-1592-4181-b979-9584d78ed303' class='xr-var-data-in' type='checkbox'><label for='data-de85ac07-1592-4181-b979-9584d78ed303' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-74.5, -73.5, -72.5, -71.5, -70.5, -69.5, -68.5, -67.5, -66.5, -65.5,
       -64.5, -63.5, -62.5, -61.5, -60.5, -59.5, -58.5, -57.5, -56.5, -55.5,
       -54.5, -53.5, -52.5, -51.5, -50.5, -49.5, -48.5, -47.5, -46.5, -45.5,
       -44.5, -43.5, -42.5, -41.5, -40.5, -39.5, -38.5, -37.5, -36.5, -35.5,
       -34.5, -33.5, -32.5, -31.5, -30.5, -29.5, -28.5, -27.5, -26.5, -25.5,
       -24.5, -23.5, -22.5, -21.5, -20.5], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-89832d31-65d2-4c90-b47f-360794167bec' class='xr-section-summary-in' type='checkbox'  ><label for='section-89832d31-65d2-4c90-b47f-360794167bec' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4b1e4422-723c-4680-9be0-491e0281ae54' class='xr-index-data-in' type='checkbox'/><label for='index-4b1e4422-723c-4680-9be0-491e0281ae54' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1997-08-16 12:00:00&#x27;, &#x27;1997-09-16 00:00:00&#x27;,
               &#x27;1998-08-16 12:00:00&#x27;, &#x27;1998-09-16 00:00:00&#x27;,
               &#x27;1999-08-16 12:00:00&#x27;, &#x27;1999-09-16 00:00:00&#x27;,
               &#x27;2000-08-16 12:00:00&#x27;, &#x27;2000-09-16 00:00:00&#x27;,
               &#x27;2001-08-16 12:00:00&#x27;, &#x27;2001-09-16 00:00:00&#x27;,
               &#x27;2002-08-16 12:00:00&#x27;, &#x27;2002-09-16 00:00:00&#x27;,
               &#x27;2003-08-16 12:00:00&#x27;, &#x27;2003-09-16 00:00:00&#x27;,
               &#x27;2004-08-16 12:00:00&#x27;, &#x27;2004-09-16 00:00:00&#x27;,
               &#x27;2005-08-16 12:00:00&#x27;, &#x27;2005-09-16 00:00:00&#x27;,
               &#x27;2006-08-16 12:00:00&#x27;, &#x27;2006-09-16 00:00:00&#x27;,
               &#x27;2007-08-16 12:00:00&#x27;, &#x27;2007-09-16 00:00:00&#x27;,
               &#x27;2008-08-16 12:00:00&#x27;, &#x27;2008-09-16 12:00:00&#x27;,
               &#x27;2009-08-16 12:00:00&#x27;, &#x27;2009-09-16 12:00:00&#x27;,
               &#x27;2010-08-16 12:00:00&#x27;, &#x27;2010-09-16 12:00:00&#x27;,
               &#x27;2011-08-16 12:00:00&#x27;, &#x27;2011-09-16 12:00:00&#x27;,
               &#x27;2012-08-16 12:00:00&#x27;, &#x27;2012-09-16 12:00:00&#x27;,
               &#x27;2013-08-16 12:00:00&#x27;, &#x27;2013-09-16 12:00:00&#x27;,
               &#x27;2014-08-16 12:00:00&#x27;, &#x27;2014-09-16 12:00:00&#x27;,
               &#x27;2015-08-16 12:00:00&#x27;, &#x27;2015-09-16 12:00:00&#x27;,
               &#x27;2016-08-16 12:00:00&#x27;, &#x27;2016-09-16 12:00:00&#x27;,
               &#x27;2017-08-16 12:00:00&#x27;, &#x27;2017-09-16 12:00:00&#x27;,
               &#x27;2018-08-16 12:00:00&#x27;, &#x27;2018-09-16 12:00:00&#x27;,
               &#x27;2019-08-16 12:00:00&#x27;, &#x27;2019-09-16 12:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2748a011-d49a-4883-a3ce-555da275babc' class='xr-index-data-in' type='checkbox'/><label for='index-2748a011-d49a-4883-a3ce-555da275babc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([24.5, 23.5, 22.5, 21.5, 20.5, 19.5, 18.5, 17.5, 16.5, 15.5, 14.5, 13.5,
       12.5, 11.5, 10.5,  9.5,  8.5,  7.5,  6.5,  5.5],
      dtype=&#x27;float32&#x27;, name=&#x27;latitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a2ec3b2c-56b4-4eb6-8fb5-67599735f69f' class='xr-index-data-in' type='checkbox'/><label for='index-a2ec3b2c-56b4-4eb6-8fb5-67599735f69f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-74.5, -73.5, -72.5, -71.5, -70.5, -69.5, -68.5, -67.5, -66.5, -65.5,
       -64.5, -63.5, -62.5, -61.5, -60.5, -59.5, -58.5, -57.5, -56.5, -55.5,
       -54.5, -53.5, -52.5, -51.5, -50.5, -49.5, -48.5, -47.5, -46.5, -45.5,
       -44.5, -43.5, -42.5, -41.5, -40.5, -39.5, -38.5, -37.5, -36.5, -35.5,
       -34.5, -33.5, -32.5, -31.5, -30.5, -29.5, -28.5, -27.5, -26.5, -25.5,
       -24.5, -23.5, -22.5, -21.5, -20.5],
      dtype=&#x27;float32&#x27;, name=&#x27;longitude&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-43c98cb2-8e9e-4b7a-931e-aa5954c8f7ed' class='xr-section-summary-in' type='checkbox'  checked><label for='section-43c98cb2-8e9e-4b7a-931e-aa5954c8f7ed' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_surface_temperature</dd><dt><span>long_name :</span></dt><dd>sst</dd><dt><span>units :</span></dt><dd>C</dd><dt><span>cell_methods :</span></dt><dd>time: lat: lon: mean</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chl</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;CHL&#x27; (time: 92, lat: 296, lon: 257)&gt; Size: 28MB
[6998624 values with dtype=float32]
Coordinates:
  * time     (time) datetime64[ns] 736B 1998-02-01 1998-03-01 ... 2020-05-01
  * lat      (lat) float32 1kB 35.01 35.02 35.03 35.04 ... 37.97 37.98 37.99
  * lon      (lon) float32 1kB -5.39 -5.377 -5.364 ... -2.126 -2.114 -2.101
    year     (time) int64 736B ...
Attributes:
    long_name:      Monthly Multi-sensor and multi water-type Chlorophyll a c...
    standard_name:  mass_concentration_of_chlorophyll_a_in_sea_water
    type:           surface
    units:          milligram m^-3
    cell_methods:   time: mean (interval: 1 month  comment: sampled instantan...
    valid_min:      0.01
    valid_max:      100.0
    source:         MODISA Aqua - Level2,VIIRSJ JPSS-1 - Level2,VIIRSN Suomi-...
    _ChunkSizes:    [   1  790 1654]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'CHL'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 92</li><li><span class='xr-has-index'>lat</span>: 296</li><li><span class='xr-has-index'>lon</span>: 257</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-b5dc2202-67ad-4763-abe1-cddd4a9f8c14' class='xr-array-in' type='checkbox' checked><label for='section-b5dc2202-67ad-4763-abe1-cddd4a9f8c14' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[6998624 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-f03a8bc6-aac9-48aa-a0a6-01dbf773cfea' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f03a8bc6-aac9-48aa-a0a6-01dbf773cfea' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-02-01 ... 2020-05-01</div><input id='attrs-e07cf4f2-8312-453f-ac24-9c48a7f9c26d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e07cf4f2-8312-453f-ac24-9c48a7f9c26d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4c118b5e-abd5-4a1e-a9f1-66f74ecf5b87' class='xr-var-data-in' type='checkbox'><label for='data-4c118b5e-abd5-4a1e-a9f1-66f74ecf5b87' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>_ChunkSizes :</span></dt><dd>1</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-02-01T00:00:00.000000000&#x27;, &#x27;1998-03-01T00:00:00.000000000&#x27;,
       &#x27;1998-04-01T00:00:00.000000000&#x27;, &#x27;1998-05-01T00:00:00.000000000&#x27;,
       &#x27;1999-02-01T00:00:00.000000000&#x27;, &#x27;1999-03-01T00:00:00.000000000&#x27;,
       &#x27;1999-04-01T00:00:00.000000000&#x27;, &#x27;1999-05-01T00:00:00.000000000&#x27;,
       &#x27;2000-02-01T00:00:00.000000000&#x27;, &#x27;2000-03-01T00:00:00.000000000&#x27;,
       &#x27;2000-04-01T00:00:00.000000000&#x27;, &#x27;2000-05-01T00:00:00.000000000&#x27;,
       &#x27;2001-02-01T00:00:00.000000000&#x27;, &#x27;2001-03-01T00:00:00.000000000&#x27;,
       &#x27;2001-04-01T00:00:00.000000000&#x27;, &#x27;2001-05-01T00:00:00.000000000&#x27;,
       &#x27;2002-02-01T00:00:00.000000000&#x27;, &#x27;2002-03-01T00:00:00.000000000&#x27;,
       &#x27;2002-04-01T00:00:00.000000000&#x27;, &#x27;2002-05-01T00:00:00.000000000&#x27;,
       &#x27;2003-02-01T00:00:00.000000000&#x27;, &#x27;2003-03-01T00:00:00.000000000&#x27;,
       &#x27;2003-04-01T00:00:00.000000000&#x27;, &#x27;2003-05-01T00:00:00.000000000&#x27;,
       &#x27;2004-02-01T00:00:00.000000000&#x27;, &#x27;2004-03-01T00:00:00.000000000&#x27;,
       &#x27;2004-04-01T00:00:00.000000000&#x27;, &#x27;2004-05-01T00:00:00.000000000&#x27;,
       &#x27;2005-02-01T00:00:00.000000000&#x27;, &#x27;2005-03-01T00:00:00.000000000&#x27;,
       &#x27;2005-04-01T00:00:00.000000000&#x27;, &#x27;2005-05-01T00:00:00.000000000&#x27;,
       &#x27;2006-02-01T00:00:00.000000000&#x27;, &#x27;2006-03-01T00:00:00.000000000&#x27;,
       &#x27;2006-04-01T00:00:00.000000000&#x27;, &#x27;2006-05-01T00:00:00.000000000&#x27;,
       &#x27;2007-02-01T00:00:00.000000000&#x27;, &#x27;2007-03-01T00:00:00.000000000&#x27;,
       &#x27;2007-04-01T00:00:00.000000000&#x27;, &#x27;2007-05-01T00:00:00.000000000&#x27;,
       &#x27;2008-02-01T00:00:00.000000000&#x27;, &#x27;2008-03-01T00:00:00.000000000&#x27;,
       &#x27;2008-04-01T00:00:00.000000000&#x27;, &#x27;2008-05-01T00:00:00.000000000&#x27;,
       &#x27;2009-02-01T00:00:00.000000000&#x27;, &#x27;2009-03-01T00:00:00.000000000&#x27;,
       &#x27;2009-04-01T00:00:00.000000000&#x27;, &#x27;2009-05-01T00:00:00.000000000&#x27;,
       &#x27;2010-02-01T00:00:00.000000000&#x27;, &#x27;2010-03-01T00:00:00.000000000&#x27;,
       &#x27;2010-04-01T00:00:00.000000000&#x27;, &#x27;2010-05-01T00:00:00.000000000&#x27;,
       &#x27;2011-02-01T00:00:00.000000000&#x27;, &#x27;2011-03-01T00:00:00.000000000&#x27;,
       &#x27;2011-04-01T00:00:00.000000000&#x27;, &#x27;2011-05-01T00:00:00.000000000&#x27;,
       &#x27;2012-02-01T00:00:00.000000000&#x27;, &#x27;2012-03-01T00:00:00.000000000&#x27;,
       &#x27;2012-04-01T00:00:00.000000000&#x27;, &#x27;2012-05-01T00:00:00.000000000&#x27;,
       &#x27;2013-02-01T00:00:00.000000000&#x27;, &#x27;2013-03-01T00:00:00.000000000&#x27;,
       &#x27;2013-04-01T00:00:00.000000000&#x27;, &#x27;2013-05-01T00:00:00.000000000&#x27;,
       &#x27;2014-02-01T00:00:00.000000000&#x27;, &#x27;2014-03-01T00:00:00.000000000&#x27;,
       &#x27;2014-04-01T00:00:00.000000000&#x27;, &#x27;2014-05-01T00:00:00.000000000&#x27;,
       &#x27;2015-02-01T00:00:00.000000000&#x27;, &#x27;2015-03-01T00:00:00.000000000&#x27;,
       &#x27;2015-04-01T00:00:00.000000000&#x27;, &#x27;2015-05-01T00:00:00.000000000&#x27;,
       &#x27;2016-02-01T00:00:00.000000000&#x27;, &#x27;2016-03-01T00:00:00.000000000&#x27;,
       &#x27;2016-04-01T00:00:00.000000000&#x27;, &#x27;2016-05-01T00:00:00.000000000&#x27;,
       &#x27;2017-02-01T00:00:00.000000000&#x27;, &#x27;2017-03-01T00:00:00.000000000&#x27;,
       &#x27;2017-04-01T00:00:00.000000000&#x27;, &#x27;2017-05-01T00:00:00.000000000&#x27;,
       &#x27;2018-02-01T00:00:00.000000000&#x27;, &#x27;2018-03-01T00:00:00.000000000&#x27;,
       &#x27;2018-04-01T00:00:00.000000000&#x27;, &#x27;2018-05-01T00:00:00.000000000&#x27;,
       &#x27;2019-02-01T00:00:00.000000000&#x27;, &#x27;2019-03-01T00:00:00.000000000&#x27;,
       &#x27;2019-04-01T00:00:00.000000000&#x27;, &#x27;2019-05-01T00:00:00.000000000&#x27;,
       &#x27;2020-02-01T00:00:00.000000000&#x27;, &#x27;2020-03-01T00:00:00.000000000&#x27;,
       &#x27;2020-04-01T00:00:00.000000000&#x27;, &#x27;2020-05-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>35.01 35.02 35.03 ... 37.98 37.99</div><input id='attrs-fbdd2628-8bf8-4c8d-9695-1fb3ee824723' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fbdd2628-8bf8-4c8d-9695-1fb3ee824723' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bb0fcf68-c7d5-4cfe-95a0-b14ff0b38def' class='xr-var-data-in' type='checkbox'><label for='data-bb0fcf68-c7d5-4cfe-95a0-b14ff0b38def' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>_ChunkSizes :</span></dt><dd>1580</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd></dl></div><div class='xr-var-data'><pre>array([35.007595, 35.017723, 35.027847, ..., 37.97468 , 37.98481 , 37.994938],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-5.39 -5.377 ... -2.114 -2.101</div><input id='attrs-15566b64-91b3-449e-8744-a7a76c8e7f95' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-15566b64-91b3-449e-8744-a7a76c8e7f95' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3000ca99-167d-4202-8209-6c518a229b2f' class='xr-var-data-in' type='checkbox'><label for='data-3000ca99-167d-4202-8209-6c518a229b2f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>_ChunkSizes :</span></dt><dd>3308</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lon</dd></dl></div><div class='xr-var-data'><pre>array([-5.389737, -5.376889, -5.364042, ..., -2.126436, -2.113588, -2.100741],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>year</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-896eafb2-cc81-4414-b797-1140703d7346' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-896eafb2-cc81-4414-b797-1140703d7346' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f0cbf015-dd0d-4678-9160-a686a6155b77' class='xr-var-data-in' type='checkbox'><label for='data-f0cbf015-dd0d-4678-9160-a686a6155b77' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[92 values with dtype=int64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ad88cb2b-0d5d-4e50-bb9a-5cf9ecf84f68' class='xr-section-summary-in' type='checkbox'  ><label for='section-ad88cb2b-0d5d-4e50-bb9a-5cf9ecf84f68' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ef59efbe-0df2-495f-a1e1-f9799de839e1' class='xr-index-data-in' type='checkbox'/><label for='index-ef59efbe-0df2-495f-a1e1-f9799de839e1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1998-02-01&#x27;, &#x27;1998-03-01&#x27;, &#x27;1998-04-01&#x27;, &#x27;1998-05-01&#x27;,
               &#x27;1999-02-01&#x27;, &#x27;1999-03-01&#x27;, &#x27;1999-04-01&#x27;, &#x27;1999-05-01&#x27;,
               &#x27;2000-02-01&#x27;, &#x27;2000-03-01&#x27;, &#x27;2000-04-01&#x27;, &#x27;2000-05-01&#x27;,
               &#x27;2001-02-01&#x27;, &#x27;2001-03-01&#x27;, &#x27;2001-04-01&#x27;, &#x27;2001-05-01&#x27;,
               &#x27;2002-02-01&#x27;, &#x27;2002-03-01&#x27;, &#x27;2002-04-01&#x27;, &#x27;2002-05-01&#x27;,
               &#x27;2003-02-01&#x27;, &#x27;2003-03-01&#x27;, &#x27;2003-04-01&#x27;, &#x27;2003-05-01&#x27;,
               &#x27;2004-02-01&#x27;, &#x27;2004-03-01&#x27;, &#x27;2004-04-01&#x27;, &#x27;2004-05-01&#x27;,
               &#x27;2005-02-01&#x27;, &#x27;2005-03-01&#x27;, &#x27;2005-04-01&#x27;, &#x27;2005-05-01&#x27;,
               &#x27;2006-02-01&#x27;, &#x27;2006-03-01&#x27;, &#x27;2006-04-01&#x27;, &#x27;2006-05-01&#x27;,
               &#x27;2007-02-01&#x27;, &#x27;2007-03-01&#x27;, &#x27;2007-04-01&#x27;, &#x27;2007-05-01&#x27;,
               &#x27;2008-02-01&#x27;, &#x27;2008-03-01&#x27;, &#x27;2008-04-01&#x27;, &#x27;2008-05-01&#x27;,
               &#x27;2009-02-01&#x27;, &#x27;2009-03-01&#x27;, &#x27;2009-04-01&#x27;, &#x27;2009-05-01&#x27;,
               &#x27;2010-02-01&#x27;, &#x27;2010-03-01&#x27;, &#x27;2010-04-01&#x27;, &#x27;2010-05-01&#x27;,
               &#x27;2011-02-01&#x27;, &#x27;2011-03-01&#x27;, &#x27;2011-04-01&#x27;, &#x27;2011-05-01&#x27;,
               &#x27;2012-02-01&#x27;, &#x27;2012-03-01&#x27;, &#x27;2012-04-01&#x27;, &#x27;2012-05-01&#x27;,
               &#x27;2013-02-01&#x27;, &#x27;2013-03-01&#x27;, &#x27;2013-04-01&#x27;, &#x27;2013-05-01&#x27;,
               &#x27;2014-02-01&#x27;, &#x27;2014-03-01&#x27;, &#x27;2014-04-01&#x27;, &#x27;2014-05-01&#x27;,
               &#x27;2015-02-01&#x27;, &#x27;2015-03-01&#x27;, &#x27;2015-04-01&#x27;, &#x27;2015-05-01&#x27;,
               &#x27;2016-02-01&#x27;, &#x27;2016-03-01&#x27;, &#x27;2016-04-01&#x27;, &#x27;2016-05-01&#x27;,
               &#x27;2017-02-01&#x27;, &#x27;2017-03-01&#x27;, &#x27;2017-04-01&#x27;, &#x27;2017-05-01&#x27;,
               &#x27;2018-02-01&#x27;, &#x27;2018-03-01&#x27;, &#x27;2018-04-01&#x27;, &#x27;2018-05-01&#x27;,
               &#x27;2019-02-01&#x27;, &#x27;2019-03-01&#x27;, &#x27;2019-04-01&#x27;, &#x27;2019-05-01&#x27;,
               &#x27;2020-02-01&#x27;, &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-084b3130-87f1-4615-a078-d6dd2c2e77ce' class='xr-index-data-in' type='checkbox'/><label for='index-084b3130-87f1-4615-a078-d6dd2c2e77ce' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 35.00759506225586, 35.017723083496094,  35.02784729003906,
         35.0379753112793, 35.048099517822266,   35.0582275390625,
       35.068355560302734,   35.0784797668457,  35.08860778808594,
        35.09873580932617,
       ...
         37.9037971496582,  37.91392517089844, 37.924049377441406,
        37.93417739868164, 37.944305419921875, 37.954429626464844,
        37.96455764770508,  37.97468185424805,  37.98480987548828,
       37.994937896728516],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=296))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-74246a83-52c9-4def-ab7e-54bf3af8fb29' class='xr-index-data-in' type='checkbox'/><label for='index-74246a83-52c9-4def-ab7e-54bf3af8fb29' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -5.389737129211426,  -5.376889228820801,  -5.364041805267334,
        -5.351193904876709,  -5.338346481323242,  -5.325498580932617,
         -5.31265115737915,  -5.299803733825684,  -5.286955833435059,
        -5.274108409881592,
       ...
        -2.216369390487671,  -2.203521728515625,  -2.190674066543579,
        -2.177826404571533, -2.1649787425994873, -2.1521310806274414,
       -2.1392836570739746, -2.1264359951019287,  -2.113588333129883,
        -2.100740671157837],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=257))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6b1f6b23-9087-4bb2-92db-794845becad6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6b1f6b23-9087-4bb2-92db-794845becad6' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly Multi-sensor and multi water-type Chlorophyll a concentration</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_chlorophyll_a_in_sea_water</dd><dt><span>type :</span></dt><dd>surface</dd><dt><span>units :</span></dt><dd>milligram m^-3</dd><dt><span>cell_methods :</span></dt><dd>time: mean (interval: 1 month  comment: sampled instantaneously)</dd><dt><span>valid_min :</span></dt><dd>0.01</dd><dt><span>valid_max :</span></dt><dd>100.0</dd><dt><span>source :</span></dt><dd>MODISA Aqua - Level2,VIIRSJ JPSS-1 - Level2,VIIRSN Suomi-NPP - Level2</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1  790 1654]</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chl</span> <span class="o">=</span> <span class="n">chl</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">5.3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">))</span>
<span class="n">chl</span> <span class="o">=</span> <span class="n">chl</span><span class="p">[(</span><span class="n">chl</span><span class="p">[</span><span class="s2">&quot;time.year&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1998</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">chl</span><span class="p">[</span><span class="s2">&quot;time.year&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2020</span><span class="p">)]</span>
<span class="n">chl</span> <span class="o">=</span> <span class="n">chl</span><span class="p">[(</span><span class="n">chl</span><span class="p">[</span><span class="s2">&quot;time.month&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">chl</span><span class="p">[</span><span class="s2">&quot;time.month&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chl</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;CHL&#x27; (time: 46, lat: 99, lon: 250)&gt; Size: 5MB
[1138500 values with dtype=float32]
Coordinates:
  * time     (time) datetime64[ns] 368B 1998-03-01 1998-04-01 ... 2020-04-01
  * lat      (lat) float32 396B 36.0 36.01 36.02 36.03 ... 36.97 36.98 36.99
  * lon      (lon) float32 1kB -5.3 -5.287 -5.274 ... -2.126 -2.114 -2.101
    year     (time) int64 368B ...
Attributes:
    long_name:      Monthly Multi-sensor and multi water-type Chlorophyll a c...
    standard_name:  mass_concentration_of_chlorophyll_a_in_sea_water
    type:           surface
    units:          milligram m^-3
    cell_methods:   time: mean (interval: 1 month  comment: sampled instantan...
    valid_min:      0.01
    valid_max:      100.0
    source:         MODISA Aqua - Level2,VIIRSJ JPSS-1 - Level2,VIIRSN Suomi-...
    _ChunkSizes:    [   1  790 1654]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'CHL'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 46</li><li><span class='xr-has-index'>lat</span>: 99</li><li><span class='xr-has-index'>lon</span>: 250</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-9cf0ad04-7931-4b36-87c1-740557ff418e' class='xr-array-in' type='checkbox' checked><label for='section-9cf0ad04-7931-4b36-87c1-740557ff418e' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[1138500 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-e6357be4-4ffc-48de-a6b5-40a7aa30b414' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e6357be4-4ffc-48de-a6b5-40a7aa30b414' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-03-01 ... 2020-04-01</div><input id='attrs-33fe59b4-178c-4637-9464-f1c7127babde' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-33fe59b4-178c-4637-9464-f1c7127babde' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-232d5e5d-7dca-4159-85ab-aee410be2210' class='xr-var-data-in' type='checkbox'><label for='data-232d5e5d-7dca-4159-85ab-aee410be2210' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>_ChunkSizes :</span></dt><dd>1</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-03-01T00:00:00.000000000&#x27;, &#x27;1998-04-01T00:00:00.000000000&#x27;,
       &#x27;1999-03-01T00:00:00.000000000&#x27;, &#x27;1999-04-01T00:00:00.000000000&#x27;,
       &#x27;2000-03-01T00:00:00.000000000&#x27;, &#x27;2000-04-01T00:00:00.000000000&#x27;,
       &#x27;2001-03-01T00:00:00.000000000&#x27;, &#x27;2001-04-01T00:00:00.000000000&#x27;,
       &#x27;2002-03-01T00:00:00.000000000&#x27;, &#x27;2002-04-01T00:00:00.000000000&#x27;,
       &#x27;2003-03-01T00:00:00.000000000&#x27;, &#x27;2003-04-01T00:00:00.000000000&#x27;,
       &#x27;2004-03-01T00:00:00.000000000&#x27;, &#x27;2004-04-01T00:00:00.000000000&#x27;,
       &#x27;2005-03-01T00:00:00.000000000&#x27;, &#x27;2005-04-01T00:00:00.000000000&#x27;,
       &#x27;2006-03-01T00:00:00.000000000&#x27;, &#x27;2006-04-01T00:00:00.000000000&#x27;,
       &#x27;2007-03-01T00:00:00.000000000&#x27;, &#x27;2007-04-01T00:00:00.000000000&#x27;,
       &#x27;2008-03-01T00:00:00.000000000&#x27;, &#x27;2008-04-01T00:00:00.000000000&#x27;,
       &#x27;2009-03-01T00:00:00.000000000&#x27;, &#x27;2009-04-01T00:00:00.000000000&#x27;,
       &#x27;2010-03-01T00:00:00.000000000&#x27;, &#x27;2010-04-01T00:00:00.000000000&#x27;,
       &#x27;2011-03-01T00:00:00.000000000&#x27;, &#x27;2011-04-01T00:00:00.000000000&#x27;,
       &#x27;2012-03-01T00:00:00.000000000&#x27;, &#x27;2012-04-01T00:00:00.000000000&#x27;,
       &#x27;2013-03-01T00:00:00.000000000&#x27;, &#x27;2013-04-01T00:00:00.000000000&#x27;,
       &#x27;2014-03-01T00:00:00.000000000&#x27;, &#x27;2014-04-01T00:00:00.000000000&#x27;,
       &#x27;2015-03-01T00:00:00.000000000&#x27;, &#x27;2015-04-01T00:00:00.000000000&#x27;,
       &#x27;2016-03-01T00:00:00.000000000&#x27;, &#x27;2016-04-01T00:00:00.000000000&#x27;,
       &#x27;2017-03-01T00:00:00.000000000&#x27;, &#x27;2017-04-01T00:00:00.000000000&#x27;,
       &#x27;2018-03-01T00:00:00.000000000&#x27;, &#x27;2018-04-01T00:00:00.000000000&#x27;,
       &#x27;2019-03-01T00:00:00.000000000&#x27;, &#x27;2019-04-01T00:00:00.000000000&#x27;,
       &#x27;2020-03-01T00:00:00.000000000&#x27;, &#x27;2020-04-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>36.0 36.01 36.02 ... 36.98 36.99</div><input id='attrs-cd5e2c82-ee42-47c2-b9ff-df0600f6e835' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cd5e2c82-ee42-47c2-b9ff-df0600f6e835' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2e5e449-1764-446b-83e3-1655a193518c' class='xr-var-data-in' type='checkbox'><label for='data-f2e5e449-1764-446b-83e3-1655a193518c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>_ChunkSizes :</span></dt><dd>1580</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd></dl></div><div class='xr-var-data'><pre>array([36.      , 36.010128, 36.020252, 36.03038 , 36.040504, 36.050632,
       36.06076 , 36.070885, 36.081013, 36.09114 , 36.101265, 36.111393,
       36.121517, 36.131645, 36.141773, 36.151897, 36.162025, 36.172153,
       36.182278, 36.192406, 36.20253 , 36.212658, 36.222786, 36.23291 ,
       36.24304 , 36.253166, 36.26329 , 36.27342 , 36.283543, 36.29367 ,
       36.3038  , 36.313923, 36.32405 , 36.33418 , 36.344303, 36.35443 ,
       36.364555, 36.374683, 36.38481 , 36.394936, 36.405064, 36.41519 ,
       36.425316, 36.435444, 36.445568, 36.455696, 36.465824, 36.47595 ,
       36.486076, 36.496204, 36.50633 , 36.516457, 36.52658 , 36.53671 ,
       36.546837, 36.55696 , 36.56709 , 36.577213, 36.58734 , 36.59747 ,
       36.607594, 36.61772 , 36.62785 , 36.637974, 36.6481  , 36.658226,
       36.668354, 36.678482, 36.688606, 36.698734, 36.708862, 36.718987,
       36.729115, 36.73924 , 36.749367, 36.759495, 36.76962 , 36.779747,
       36.789875, 36.8     , 36.810127, 36.82025 , 36.83038 , 36.840508,
       36.85063 , 36.86076 , 36.870888, 36.881012, 36.89114 , 36.901264,
       36.911392, 36.92152 , 36.931644, 36.941772, 36.9519  , 36.962025,
       36.972153, 36.982277, 36.992405], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-5.3 -5.287 ... -2.114 -2.101</div><input id='attrs-784964ea-f3cc-4c06-a10b-c6565b584b0f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-784964ea-f3cc-4c06-a10b-c6565b584b0f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54e7ea1c-97e7-4a19-84ab-06c2d68d44d0' class='xr-var-data-in' type='checkbox'><label for='data-54e7ea1c-97e7-4a19-84ab-06c2d68d44d0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>_ChunkSizes :</span></dt><dd>3308</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lon</dd></dl></div><div class='xr-var-data'><pre>array([-5.299804, -5.286956, -5.274108, ..., -2.126436, -2.113588, -2.100741],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>year</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4697ec98-5e62-40b2-be50-dddbbc9ee095' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4697ec98-5e62-40b2-be50-dddbbc9ee095' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd85a919-59f4-4044-befe-5da4ab1609f7' class='xr-var-data-in' type='checkbox'><label for='data-fd85a919-59f4-4044-befe-5da4ab1609f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[46 values with dtype=int64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-89c8e671-5788-4610-89fb-eb7156147bf5' class='xr-section-summary-in' type='checkbox'  ><label for='section-89c8e671-5788-4610-89fb-eb7156147bf5' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8a67279a-2b1c-4c95-9e51-2f1b6eb84ae0' class='xr-index-data-in' type='checkbox'/><label for='index-8a67279a-2b1c-4c95-9e51-2f1b6eb84ae0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1998-03-01&#x27;, &#x27;1998-04-01&#x27;, &#x27;1999-03-01&#x27;, &#x27;1999-04-01&#x27;,
               &#x27;2000-03-01&#x27;, &#x27;2000-04-01&#x27;, &#x27;2001-03-01&#x27;, &#x27;2001-04-01&#x27;,
               &#x27;2002-03-01&#x27;, &#x27;2002-04-01&#x27;, &#x27;2003-03-01&#x27;, &#x27;2003-04-01&#x27;,
               &#x27;2004-03-01&#x27;, &#x27;2004-04-01&#x27;, &#x27;2005-03-01&#x27;, &#x27;2005-04-01&#x27;,
               &#x27;2006-03-01&#x27;, &#x27;2006-04-01&#x27;, &#x27;2007-03-01&#x27;, &#x27;2007-04-01&#x27;,
               &#x27;2008-03-01&#x27;, &#x27;2008-04-01&#x27;, &#x27;2009-03-01&#x27;, &#x27;2009-04-01&#x27;,
               &#x27;2010-03-01&#x27;, &#x27;2010-04-01&#x27;, &#x27;2011-03-01&#x27;, &#x27;2011-04-01&#x27;,
               &#x27;2012-03-01&#x27;, &#x27;2012-04-01&#x27;, &#x27;2013-03-01&#x27;, &#x27;2013-04-01&#x27;,
               &#x27;2014-03-01&#x27;, &#x27;2014-04-01&#x27;, &#x27;2015-03-01&#x27;, &#x27;2015-04-01&#x27;,
               &#x27;2016-03-01&#x27;, &#x27;2016-04-01&#x27;, &#x27;2017-03-01&#x27;, &#x27;2017-04-01&#x27;,
               &#x27;2018-03-01&#x27;, &#x27;2018-04-01&#x27;, &#x27;2019-03-01&#x27;, &#x27;2019-04-01&#x27;,
               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c756d435-d8e1-4152-aef8-b248e85a54dc' class='xr-index-data-in' type='checkbox'/><label for='index-c756d435-d8e1-4152-aef8-b248e85a54dc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              36.0, 36.010128021240234,   36.0202522277832,
        36.03038024902344, 36.040504455566406,  36.05063247680664,
       36.060760498046875, 36.070884704589844,  36.08101272583008,
        36.09114074707031,  36.10126495361328, 36.111392974853516,
       36.121517181396484,  36.13164520263672,  36.14177322387695,
        36.15189743041992, 36.162025451660156,  36.17215347290039,
        36.18227767944336, 36.192405700683594,  36.20252990722656,
         36.2126579284668,  36.22278594970703,     36.23291015625,
       36.243038177490234,  36.25316619873047,  36.26329040527344,
        36.27341842651367,  36.28354263305664, 36.293670654296875,
        36.30379867553711,  36.31392288208008,  36.32405090332031,
        36.33417892456055, 36.344303131103516,  36.35443115234375,
        36.36455535888672,  36.37468338012695,  36.38481140136719,
       36.394935607910156,  36.40506362915039, 36.415191650390625,
       36.425315856933594,  36.43544387817383,   36.4455680847168,
        36.45569610595703, 36.465824127197266, 36.475948333740234,
        36.48607635498047,   36.4962043762207,  36.50632858276367,
       36.516456604003906, 36.526580810546875,  36.53670883178711,
       36.546836853027344,  36.55696105957031,  36.56708908081055,
       36.577213287353516,  36.58734130859375, 36.597469329833984,
        36.60759353637695,  36.61772155761719,  36.62784957885742,
        36.63797378540039, 36.648101806640625, 36.658226013183594,
        36.66835403442383,  36.67848205566406,  36.68860626220703,
       36.698734283447266,   36.7088623046875,  36.71898651123047,
         36.7291145324707,  36.73923873901367, 36.749366760253906,
        36.75949478149414,  36.76961898803711, 36.779747009277344,
        36.78987503051758,  36.79999923706055,  36.81012725830078,
        36.82025146484375, 36.830379486083984,  36.84050750732422,
        36.85063171386719,  36.86075973510742, 36.870887756347656,
       36.881011962890625,  36.89113998413086,  36.90126419067383,
        36.91139221191406,   36.9215202331543, 36.931644439697266,
         36.9417724609375, 36.951900482177734,   36.9620246887207,
        36.97215270996094, 36.982276916503906,  36.99240493774414],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-096f88e3-8c8b-4113-8cbe-cae26de1e8f0' class='xr-index-data-in' type='checkbox'/><label for='index-096f88e3-8c8b-4113-8cbe-cae26de1e8f0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -5.299803733825684,  -5.286955833435059,  -5.274108409881592,
        -5.261260509490967,    -5.2484130859375,  -5.235565185546875,
        -5.222717761993408,  -5.209869861602783,  -5.197022438049316,
        -5.184174537658691,
       ...
        -2.216369390487671,  -2.203521728515625,  -2.190674066543579,
        -2.177826404571533, -2.1649787425994873, -2.1521310806274414,
       -2.1392836570739746, -2.1264359951019287,  -2.113588333129883,
        -2.100740671157837],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=250))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5b5d91d0-fddd-4856-8d14-32468c90cf5a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5b5d91d0-fddd-4856-8d14-32468c90cf5a' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly Multi-sensor and multi water-type Chlorophyll a concentration</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_chlorophyll_a_in_sea_water</dd><dt><span>type :</span></dt><dd>surface</dd><dt><span>units :</span></dt><dd>milligram m^-3</dd><dt><span>cell_methods :</span></dt><dd>time: mean (interval: 1 month  comment: sampled instantaneously)</dd><dt><span>valid_min :</span></dt><dd>0.01</dd><dt><span>valid_max :</span></dt><dd>100.0</dd><dt><span>source :</span></dt><dd>MODISA Aqua - Level2,VIIRSJ JPSS-1 - Level2,VIIRSN Suomi-NPP - Level2</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1  790 1654]</dd></dl></div></li></ul></div></div></div>
</div>
<p>Plot climatology to make sure the regions are correct</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.QuadMesh at 0x7f9ec8311b20&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_16_1.png" src="../_images/manual_Tutorial_16_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7f9eb812ed60&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_17_1.png" src="../_images/manual_Tutorial_17_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chl</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.QuadMesh at 0x7f9f1afc2b80&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_18_1.png" src="../_images/manual_Tutorial_18_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chl</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7f9ee82e3c10&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_19_1.png" src="../_images/manual_Tutorial_19_1.png" />
</div>
</div>
</section>
<section id="2.-Preprocessing">
<h3>2. Preprocessing<a class="headerlink" href="#2.-Preprocessing" title="Link to this heading">¶</a></h3>
<p>In the preprocessing stage we need to calculate the anomalies of the seasonal mean and reshape the arrays into space x time matrices</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Given that the seasons only span one year we can take the yearly mean of the time axis</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">sst</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">chl</span> <span class="o">=</span> <span class="n">chl</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">sst</span> <span class="o">-</span> <span class="n">sst</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">chl</span> <span class="o">-</span> <span class="n">chl</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;sst&#x27; (year: 23, latitude: 20, longitude: 55)&gt; Size: 101kB
array([[[29.43972 , 29.324703, 29.236721, ..., 24.867073, 24.746378,
         24.540201],
        [29.501165, 29.34866 , 29.240013, ..., 24.92178 , 24.772491,
         24.51123 ],
        [29.448833, 29.289053, 29.198196, ..., 24.95534 , 24.78917 ,
         24.522488],
        ...,
        [      nan,       nan,       nan, ..., 27.690258, 27.562199,
         27.474775],
        [      nan,       nan,       nan, ..., 27.65865 , 27.54871 ,
         27.473726],
        [      nan,       nan,       nan, ..., 27.5221  , 27.39844 ,
         27.313917]],

       [[29.418564, 29.32129 , 29.19013 , ..., 24.786026, 24.727936,
         24.534008],
        [29.48762 , 29.362225, 29.229086, ..., 24.934086, 24.766254,
         24.50972 ],
        [29.513603, 29.374004, 29.264664, ..., 25.092678, 24.783533,
         24.475266],
...
        [      nan,       nan,       nan, ..., 27.841267, 27.778168,
         27.735716],
        [      nan,       nan,       nan, ..., 27.92116 , 27.866674,
         27.815903],
        [      nan,       nan,       nan, ..., 27.870008, 27.823608,
         27.764965]],

       [[29.059797, 29.13901 , 29.207676, ..., 25.025206, 24.790546,
         24.496622],
        [29.046814, 29.10406 , 29.170261, ..., 25.064781, 24.804836,
         24.45037 ],
        [29.062769, 29.085262, 29.128931, ..., 25.093243, 24.825397,
         24.447556],
        ...,
        [      nan,       nan,       nan, ..., 27.752783, 27.660511,
         27.626997],
        [      nan,       nan,       nan, ..., 27.764326, 27.68687 ,
         27.625046],
        [      nan,       nan,       nan, ..., 27.736523, 27.646976,
         27.557606]]], dtype=float32)
Coordinates:
  * latitude   (latitude) float32 80B 24.5 23.5 22.5 21.5 ... 8.5 7.5 6.5 5.5
  * longitude  (longitude) float32 220B -74.5 -73.5 -72.5 ... -22.5 -21.5 -20.5
  * year       (year) int64 184B 1997 1998 1999 2000 ... 2016 2017 2018 2019
Attributes:
    standard_name:  sea_surface_temperature
    long_name:      sst
    units:          C
    cell_methods:   time: lat: lon: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'sst'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 23</li><li><span class='xr-has-index'>latitude</span>: 20</li><li><span class='xr-has-index'>longitude</span>: 55</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-8a119f6b-de10-4b75-b327-aaca086e8bdc' class='xr-array-in' type='checkbox' checked><label for='section-8a119f6b-de10-4b75-b327-aaca086e8bdc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>29.44 29.32 29.24 29.17 29.1 29.03 ... 27.89 27.82 27.74 27.65 27.56</span></div><div class='xr-array-data'><pre>array([[[29.43972 , 29.324703, 29.236721, ..., 24.867073, 24.746378,
         24.540201],
        [29.501165, 29.34866 , 29.240013, ..., 24.92178 , 24.772491,
         24.51123 ],
        [29.448833, 29.289053, 29.198196, ..., 24.95534 , 24.78917 ,
         24.522488],
        ...,
        [      nan,       nan,       nan, ..., 27.690258, 27.562199,
         27.474775],
        [      nan,       nan,       nan, ..., 27.65865 , 27.54871 ,
         27.473726],
        [      nan,       nan,       nan, ..., 27.5221  , 27.39844 ,
         27.313917]],

       [[29.418564, 29.32129 , 29.19013 , ..., 24.786026, 24.727936,
         24.534008],
        [29.48762 , 29.362225, 29.229086, ..., 24.934086, 24.766254,
         24.50972 ],
        [29.513603, 29.374004, 29.264664, ..., 25.092678, 24.783533,
         24.475266],
...
        [      nan,       nan,       nan, ..., 27.841267, 27.778168,
         27.735716],
        [      nan,       nan,       nan, ..., 27.92116 , 27.866674,
         27.815903],
        [      nan,       nan,       nan, ..., 27.870008, 27.823608,
         27.764965]],

       [[29.059797, 29.13901 , 29.207676, ..., 25.025206, 24.790546,
         24.496622],
        [29.046814, 29.10406 , 29.170261, ..., 25.064781, 24.804836,
         24.45037 ],
        [29.062769, 29.085262, 29.128931, ..., 25.093243, 24.825397,
         24.447556],
        ...,
        [      nan,       nan,       nan, ..., 27.752783, 27.660511,
         27.626997],
        [      nan,       nan,       nan, ..., 27.764326, 27.68687 ,
         27.625046],
        [      nan,       nan,       nan, ..., 27.736523, 27.646976,
         27.557606]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-e6afd6fc-361d-4ce7-bcef-e395b036a7fb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e6afd6fc-361d-4ce7-bcef-e395b036a7fb' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>24.5 23.5 22.5 21.5 ... 7.5 6.5 5.5</div><input id='attrs-bf3709b0-50cc-4d34-9c24-947c6f3cb9c7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bf3709b0-50cc-4d34-9c24-947c6f3cb9c7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3c95d7d5-a96e-482b-8544-0a67efb74df2' class='xr-var-data-in' type='checkbox'><label for='data-3c95d7d5-a96e-482b-8544-0a67efb74df2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([24.5, 23.5, 22.5, 21.5, 20.5, 19.5, 18.5, 17.5, 16.5, 15.5, 14.5, 13.5,
       12.5, 11.5, 10.5,  9.5,  8.5,  7.5,  6.5,  5.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-74.5 -73.5 -72.5 ... -21.5 -20.5</div><input id='attrs-edea62e9-372c-4b56-bfd5-219ee98e09d1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-edea62e9-372c-4b56-bfd5-219ee98e09d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80caee65-1516-4cec-9a93-9b5b9c6b4ead' class='xr-var-data-in' type='checkbox'><label for='data-80caee65-1516-4cec-9a93-9b5b9c6b4ead' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-74.5, -73.5, -72.5, -71.5, -70.5, -69.5, -68.5, -67.5, -66.5, -65.5,
       -64.5, -63.5, -62.5, -61.5, -60.5, -59.5, -58.5, -57.5, -56.5, -55.5,
       -54.5, -53.5, -52.5, -51.5, -50.5, -49.5, -48.5, -47.5, -46.5, -45.5,
       -44.5, -43.5, -42.5, -41.5, -40.5, -39.5, -38.5, -37.5, -36.5, -35.5,
       -34.5, -33.5, -32.5, -31.5, -30.5, -29.5, -28.5, -27.5, -26.5, -25.5,
       -24.5, -23.5, -22.5, -21.5, -20.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1997 1998 1999 ... 2017 2018 2019</div><input id='attrs-35c5c859-6357-43ed-ac1d-90839a2868b2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-35c5c859-6357-43ed-ac1d-90839a2868b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b3070bc-525b-44ae-9d43-fdf582cbec27' class='xr-var-data-in' type='checkbox'><label for='data-7b3070bc-525b-44ae-9d43-fdf582cbec27' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,
       2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7fb52ab4-d2aa-49c7-a023-96cf2993976b' class='xr-section-summary-in' type='checkbox'  ><label for='section-7fb52ab4-d2aa-49c7-a023-96cf2993976b' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cb5abd09-9397-4c94-a8ee-a4a0e76272b8' class='xr-index-data-in' type='checkbox'/><label for='index-cb5abd09-9397-4c94-a8ee-a4a0e76272b8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([24.5, 23.5, 22.5, 21.5, 20.5, 19.5, 18.5, 17.5, 16.5, 15.5, 14.5, 13.5,
       12.5, 11.5, 10.5,  9.5,  8.5,  7.5,  6.5,  5.5],
      dtype=&#x27;float32&#x27;, name=&#x27;latitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9b1b8599-4865-4575-b085-419fe5175fbb' class='xr-index-data-in' type='checkbox'/><label for='index-9b1b8599-4865-4575-b085-419fe5175fbb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-74.5, -73.5, -72.5, -71.5, -70.5, -69.5, -68.5, -67.5, -66.5, -65.5,
       -64.5, -63.5, -62.5, -61.5, -60.5, -59.5, -58.5, -57.5, -56.5, -55.5,
       -54.5, -53.5, -52.5, -51.5, -50.5, -49.5, -48.5, -47.5, -46.5, -45.5,
       -44.5, -43.5, -42.5, -41.5, -40.5, -39.5, -38.5, -37.5, -36.5, -35.5,
       -34.5, -33.5, -32.5, -31.5, -30.5, -29.5, -28.5, -27.5, -26.5, -25.5,
       -24.5, -23.5, -22.5, -21.5, -20.5],
      dtype=&#x27;float32&#x27;, name=&#x27;longitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-111e9a3e-12ad-4401-b65e-056d8b36da59' class='xr-index-data-in' type='checkbox'/><label for='index-111e9a3e-12ad-4401-b65e-056d8b36da59' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,
       2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-658817ed-ea75-40df-8ff6-870c5371149c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-658817ed-ea75-40df-8ff6-870c5371149c' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_surface_temperature</dd><dt><span>long_name :</span></dt><dd>sst</dd><dt><span>units :</span></dt><dd>C</dd><dt><span>cell_methods :</span></dt><dd>time: lat: lon: mean</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chl</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;CHL&#x27; (year: 23, lat: 99, lon: 250)&gt; Size: 2MB
array([[[0.21465224, 0.2473787 , 0.22719526, ..., 0.12090172,
         0.12297925, 0.1198298 ],
        [0.23239255, 0.22782484, 0.2263079 , ..., 0.12343679,
         0.11864622, 0.11867309],
        [0.2286636 , 0.20803559, 0.20788139, ..., 0.12761016,
         0.12068577, 0.12094864],
        ...,
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[0.16464871, 0.18137816, 0.18113448, ..., 0.310634  ,
         0.30567884, 0.29548663],
        [0.18559793, 0.18445052, 0.18071373, ..., 0.27648756,
         0.29144764, 0.27454275],
        [0.18167377, 0.17825404, 0.19277668, ..., 0.29028517,
         0.28167462, 0.28074667],
...
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[0.13607499, 0.13884723, 0.13911843, ..., 0.11104058,
         0.11072575, 0.11365105],
        [0.14470449, 0.1443741 , 0.14499024, ..., 0.12129846,
         0.11603758, 0.11563934],
        [0.16214469, 0.1638612 , 0.17014524, ..., 0.14019011,
         0.12605241, 0.11876828],
        ...,
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]]], dtype=float32)
Coordinates:
  * lat      (lat) float32 396B 36.0 36.01 36.02 36.03 ... 36.97 36.98 36.99
  * lon      (lon) float32 1kB -5.3 -5.287 -5.274 ... -2.126 -2.114 -2.101
  * year     (year) int64 184B 1998 1999 2000 2001 2002 ... 2017 2018 2019 2020
Attributes:
    long_name:      Monthly Multi-sensor and multi water-type Chlorophyll a c...
    standard_name:  mass_concentration_of_chlorophyll_a_in_sea_water
    type:           surface
    units:          milligram m^-3
    cell_methods:   time: mean (interval: 1 month  comment: sampled instantan...
    valid_min:      0.01
    valid_max:      100.0
    source:         MODISA Aqua - Level2,VIIRSJ JPSS-1 - Level2,VIIRSN Suomi-...
    _ChunkSizes:    [   1  790 1654]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'CHL'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 23</li><li><span class='xr-has-index'>lat</span>: 99</li><li><span class='xr-has-index'>lon</span>: 250</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-32655b79-2ee8-4040-908f-42557dbed0b6' class='xr-array-in' type='checkbox' checked><label for='section-32655b79-2ee8-4040-908f-42557dbed0b6' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.2147 0.2474 0.2272 0.2409 0.2358 0.22 ... nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[[0.21465224, 0.2473787 , 0.22719526, ..., 0.12090172,
         0.12297925, 0.1198298 ],
        [0.23239255, 0.22782484, 0.2263079 , ..., 0.12343679,
         0.11864622, 0.11867309],
        [0.2286636 , 0.20803559, 0.20788139, ..., 0.12761016,
         0.12068577, 0.12094864],
        ...,
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[0.16464871, 0.18137816, 0.18113448, ..., 0.310634  ,
         0.30567884, 0.29548663],
        [0.18559793, 0.18445052, 0.18071373, ..., 0.27648756,
         0.29144764, 0.27454275],
        [0.18167377, 0.17825404, 0.19277668, ..., 0.29028517,
         0.28167462, 0.28074667],
...
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[0.13607499, 0.13884723, 0.13911843, ..., 0.11104058,
         0.11072575, 0.11365105],
        [0.14470449, 0.1443741 , 0.14499024, ..., 0.12129846,
         0.11603758, 0.11563934],
        [0.16214469, 0.1638612 , 0.17014524, ..., 0.14019011,
         0.12605241, 0.11876828],
        ...,
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-101ca335-4db8-4b21-8df2-0212e0cdd25a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-101ca335-4db8-4b21-8df2-0212e0cdd25a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>36.0 36.01 36.02 ... 36.98 36.99</div><input id='attrs-8e7a5360-ec92-4e3d-87be-a6b31da5c1f1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8e7a5360-ec92-4e3d-87be-a6b31da5c1f1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eabf20b6-7cf6-4624-a79b-e8b62707cfc0' class='xr-var-data-in' type='checkbox'><label for='data-eabf20b6-7cf6-4624-a79b-e8b62707cfc0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>_ChunkSizes :</span></dt><dd>1580</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd></dl></div><div class='xr-var-data'><pre>array([36.      , 36.010128, 36.020252, 36.03038 , 36.040504, 36.050632,
       36.06076 , 36.070885, 36.081013, 36.09114 , 36.101265, 36.111393,
       36.121517, 36.131645, 36.141773, 36.151897, 36.162025, 36.172153,
       36.182278, 36.192406, 36.20253 , 36.212658, 36.222786, 36.23291 ,
       36.24304 , 36.253166, 36.26329 , 36.27342 , 36.283543, 36.29367 ,
       36.3038  , 36.313923, 36.32405 , 36.33418 , 36.344303, 36.35443 ,
       36.364555, 36.374683, 36.38481 , 36.394936, 36.405064, 36.41519 ,
       36.425316, 36.435444, 36.445568, 36.455696, 36.465824, 36.47595 ,
       36.486076, 36.496204, 36.50633 , 36.516457, 36.52658 , 36.53671 ,
       36.546837, 36.55696 , 36.56709 , 36.577213, 36.58734 , 36.59747 ,
       36.607594, 36.61772 , 36.62785 , 36.637974, 36.6481  , 36.658226,
       36.668354, 36.678482, 36.688606, 36.698734, 36.708862, 36.718987,
       36.729115, 36.73924 , 36.749367, 36.759495, 36.76962 , 36.779747,
       36.789875, 36.8     , 36.810127, 36.82025 , 36.83038 , 36.840508,
       36.85063 , 36.86076 , 36.870888, 36.881012, 36.89114 , 36.901264,
       36.911392, 36.92152 , 36.931644, 36.941772, 36.9519  , 36.962025,
       36.972153, 36.982277, 36.992405], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-5.3 -5.287 ... -2.114 -2.101</div><input id='attrs-fbba33cd-9fa6-49ae-919e-12532faef869' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fbba33cd-9fa6-49ae-919e-12532faef869' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b97a2b54-2465-451b-9503-7d63cbc23fb3' class='xr-var-data-in' type='checkbox'><label for='data-b97a2b54-2465-451b-9503-7d63cbc23fb3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>_ChunkSizes :</span></dt><dd>3308</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lon</dd></dl></div><div class='xr-var-data'><pre>array([-5.299804, -5.286956, -5.274108, ..., -2.126436, -2.113588, -2.100741],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1998 1999 2000 ... 2018 2019 2020</div><input id='attrs-7d87bf1e-7314-4156-85c4-2169e45092a2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d87bf1e-7314-4156-85c4-2169e45092a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3cd9a8b-b606-492a-9e29-7b68eaa9dcf2' class='xr-var-data-in' type='checkbox'><label for='data-e3cd9a8b-b606-492a-9e29-7b68eaa9dcf2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009,
       2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d1061613-a74e-4e4e-9707-5416e511d42e' class='xr-section-summary-in' type='checkbox'  ><label for='section-d1061613-a74e-4e4e-9707-5416e511d42e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-63f35bb2-8e01-4517-9e05-0ffedb1cea2e' class='xr-index-data-in' type='checkbox'/><label for='index-63f35bb2-8e01-4517-9e05-0ffedb1cea2e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              36.0, 36.010128021240234,   36.0202522277832,
        36.03038024902344, 36.040504455566406,  36.05063247680664,
       36.060760498046875, 36.070884704589844,  36.08101272583008,
        36.09114074707031,  36.10126495361328, 36.111392974853516,
       36.121517181396484,  36.13164520263672,  36.14177322387695,
        36.15189743041992, 36.162025451660156,  36.17215347290039,
        36.18227767944336, 36.192405700683594,  36.20252990722656,
         36.2126579284668,  36.22278594970703,     36.23291015625,
       36.243038177490234,  36.25316619873047,  36.26329040527344,
        36.27341842651367,  36.28354263305664, 36.293670654296875,
        36.30379867553711,  36.31392288208008,  36.32405090332031,
        36.33417892456055, 36.344303131103516,  36.35443115234375,
        36.36455535888672,  36.37468338012695,  36.38481140136719,
       36.394935607910156,  36.40506362915039, 36.415191650390625,
       36.425315856933594,  36.43544387817383,   36.4455680847168,
        36.45569610595703, 36.465824127197266, 36.475948333740234,
        36.48607635498047,   36.4962043762207,  36.50632858276367,
       36.516456604003906, 36.526580810546875,  36.53670883178711,
       36.546836853027344,  36.55696105957031,  36.56708908081055,
       36.577213287353516,  36.58734130859375, 36.597469329833984,
        36.60759353637695,  36.61772155761719,  36.62784957885742,
        36.63797378540039, 36.648101806640625, 36.658226013183594,
        36.66835403442383,  36.67848205566406,  36.68860626220703,
       36.698734283447266,   36.7088623046875,  36.71898651123047,
         36.7291145324707,  36.73923873901367, 36.749366760253906,
        36.75949478149414,  36.76961898803711, 36.779747009277344,
        36.78987503051758,  36.79999923706055,  36.81012725830078,
        36.82025146484375, 36.830379486083984,  36.84050750732422,
        36.85063171386719,  36.86075973510742, 36.870887756347656,
       36.881011962890625,  36.89113998413086,  36.90126419067383,
        36.91139221191406,   36.9215202331543, 36.931644439697266,
         36.9417724609375, 36.951900482177734,   36.9620246887207,
        36.97215270996094, 36.982276916503906,  36.99240493774414],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bd4e77e7-fe63-4b0b-8d22-3b1ee1208a8d' class='xr-index-data-in' type='checkbox'/><label for='index-bd4e77e7-fe63-4b0b-8d22-3b1ee1208a8d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -5.299803733825684,  -5.286955833435059,  -5.274108409881592,
        -5.261260509490967,    -5.2484130859375,  -5.235565185546875,
        -5.222717761993408,  -5.209869861602783,  -5.197022438049316,
        -5.184174537658691,
       ...
        -2.216369390487671,  -2.203521728515625,  -2.190674066543579,
        -2.177826404571533, -2.1649787425994873, -2.1521310806274414,
       -2.1392836570739746, -2.1264359951019287,  -2.113588333129883,
        -2.100740671157837],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=250))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-024320cc-f04e-4d62-9098-8f0d4717b113' class='xr-index-data-in' type='checkbox'/><label for='index-024320cc-f04e-4d62-9098-8f0d4717b113' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009,
       2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-443fa3fb-3cf8-45b9-b48d-32b0e34644f6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-443fa3fb-3cf8-45b9-b48d-32b0e34644f6' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly Multi-sensor and multi water-type Chlorophyll a concentration</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_chlorophyll_a_in_sea_water</dd><dt><span>type :</span></dt><dd>surface</dd><dt><span>units :</span></dt><dd>milligram m^-3</dd><dt><span>cell_methods :</span></dt><dd>time: mean (interval: 1 month  comment: sampled instantaneously)</dd><dt><span>valid_min :</span></dt><dd>0.01</dd><dt><span>valid_max :</span></dt><dd>100.0</dd><dt><span>source :</span></dt><dd>MODISA Aqua - Level2,VIIRSJ JPSS-1 - Level2,VIIRSN Suomi-NPP - Level2</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1  790 1654]</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(23, 20, 55)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">sst</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sst</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sst</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sst</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">chl</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">chl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">chl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">chl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<p>Apply detrending to the predictor field</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_land_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># Masks where the land is</span>
<span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">y_land_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">y_land_mask</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_land_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="3.-Perform-MCA">
<h3>3. Perform MCA<a class="headerlink" href="#3.-Perform-MCA" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nm</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Calculate up to 3 modes</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Significance level for Pearson correlation</span>
</pre></div>
</div>
</div>
<p>Calculate the convariance matrix</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">y_land_mask</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="o">~</span><span class="n">z_land_mask</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p>Singular Value Decomposition</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span> <span class="n">_d</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svds</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nm</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;LM&#39;</span><span class="p">)</span>  <span class="c1"># Which LM = Large magnitude</span>

<span class="c1"># Modes are reversed so we reverse them in r, d and q</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">_d</span> <span class="o">=</span> <span class="n">_d</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">svdvals</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svdvals</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">scf</span> <span class="o">=</span> <span class="n">svdvals</span><span class="p">[:</span><span class="n">nm</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">svdvals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time series of covariability</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">y_land_mask</span><span class="p">]),</span> <span class="n">r</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="o">~</span><span class="n">z_land_mask</span><span class="p">]),</span> <span class="n">q</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>

<span class="n">Us</span> <span class="o">=</span> <span class="p">((</span><span class="n">u</span> <span class="o">-</span> <span class="n">u</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  <span class="c1"># Standarized anom across axis 0</span>
<span class="n">Vs</span> <span class="o">=</span> <span class="p">((</span><span class="n">v</span> <span class="o">-</span> <span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="n">v</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<p>Perform index regression to get the modes of variability</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nt</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Must be the same as z.shape[1]</span>

<span class="n">RUY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">ny</span><span class="p">,</span> <span class="n">nm</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">SUY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">ny</span><span class="p">,</span> <span class="n">nm</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">pvalruy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">ny</span><span class="p">,</span> <span class="n">nm</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">RUZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nz</span><span class="p">,</span> <span class="n">nm</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">SUZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nz</span><span class="p">,</span> <span class="n">nm</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">pvalruz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nz</span><span class="p">,</span> <span class="n">nm</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">RUY</span><span class="p">[</span><span class="n">y_land_mask</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">pvalruy</span><span class="p">[</span><span class="n">y_land_mask</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">RUZ</span><span class="p">[</span><span class="n">z_land_mask</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">pvalruz</span><span class="p">[</span><span class="n">z_land_mask</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nm</span><span class="p">):</span>
    <span class="n">SUY</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Us</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="n">nt</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">y_land_mask</span><span class="p">],</span> <span class="n">Us</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">RUY</span><span class="p">[</span><span class="o">~</span><span class="n">y_land_mask</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">pvalruy</span><span class="p">[</span><span class="o">~</span><span class="n">y_land_mask</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">SUZ</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Us</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="n">nt</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">[</span><span class="o">~</span><span class="n">z_land_mask</span><span class="p">],</span> <span class="n">Us</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">RUZ</span><span class="p">[</span><span class="o">~</span><span class="n">z_land_mask</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">pvalruz</span><span class="p">[</span><span class="o">~</span><span class="n">z_land_mask</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">RUY_sig</span> <span class="o">=</span> <span class="n">RUY</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">SUY_sig</span> <span class="o">=</span> <span class="n">SUY</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">RUY_sig</span><span class="p">[</span><span class="n">pvalruy</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">SUY_sig</span><span class="p">[</span><span class="n">pvalruy</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">RUZ_sig</span> <span class="o">=</span> <span class="n">RUZ</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">SUZ_sig</span> <span class="o">=</span> <span class="n">SUZ</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">RUZ_sig</span><span class="p">[</span><span class="n">pvalruz</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">SUZ_sig</span><span class="p">[</span><span class="n">pvalruz</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Plot-MCA">
<h3>4. Plot MCA<a class="headerlink" href="#4.-Plot-MCA" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Figure size 1400x800 with 0 Axes&gt;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nm</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">Us</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Us&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">Vs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Vs&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nm</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

    <span class="n">ru</span><span class="p">,</span> <span class="n">ru_sig</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span> <span class="o">=</span> <span class="n">RUY</span><span class="p">,</span> <span class="n">RUY_sig</span><span class="p">,</span> <span class="n">sst</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">sst</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">ru</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)))</span>
    <span class="n">th</span> <span class="o">=</span> <span class="n">ru_sig</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)))</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
        <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;bwr&quot;</span><span class="p">,</span>
        <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
        <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">th</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">hatches</span><span class="o">=</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nm</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

    <span class="n">ru</span><span class="p">,</span> <span class="n">ru_sig</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span> <span class="o">=</span> <span class="n">RUZ</span><span class="p">,</span> <span class="n">RUZ_sig</span><span class="p">,</span> <span class="n">chl</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span> <span class="n">chl</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">ru</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)))</span>
    <span class="n">th</span> <span class="o">=</span> <span class="n">ru_sig</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)))</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
        <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
        <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
        <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">th</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">hatches</span><span class="o">=</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;MCA&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0.98, &#39;MCA&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_44_0.png" src="../_images/manual_Tutorial_44_0.png" />
</div>
</div>
</section>
</section>
<section id="Using-Spy4Cast">
<h2>Using Spy4Cast<a class="headerlink" href="#Using-Spy4Cast" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spy4cast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Region</span><span class="p">,</span> <span class="n">Month</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">spy4cast.spy4cast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Preprocess</span><span class="p">,</span> <span class="n">MCA</span><span class="p">,</span> <span class="n">Crossvalidation</span>
</pre></div>
</div>
</div>
<section id="id1">
<h3>1. Configuration<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>Configuration is srtraight forward with the abstractions spy4cast provides.</p>
<p>This enhances productivity and makes it easier to change the parameters of the run. It is also quite straight-forward to declare seasons that span through a year like NDJ, which requires more logic with xarray</p>
<p>Also it provides a <code class="docutils literal notranslate"><span class="pre">skip</span></code> option to reduce the dimension of the dataset. This makes ir faster for the first runs and you can decrease it to 0 for the final output</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictor</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">PREDICTOR_NAME</span><span class="p">,</span> <span class="n">DATASET_DIR</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;sst&quot;</span><span class="p">)</span>
<span class="n">sst_region</span> <span class="o">=</span> <span class="n">Region</span><span class="p">(</span>
    <span class="n">lat0</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">latf</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">lon0</span><span class="o">=-</span><span class="mi">75</span><span class="p">,</span> <span class="n">lonf</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">month0</span><span class="o">=</span><span class="n">Month</span><span class="o">.</span><span class="n">AUG</span><span class="p">,</span> <span class="n">monthf</span><span class="o">=</span><span class="n">Month</span><span class="o">.</span><span class="n">SEP</span><span class="p">,</span>
    <span class="n">year0</span><span class="o">=</span><span class="mi">1997</span><span class="p">,</span> <span class="n">yearf</span><span class="o">=</span><span class="mi">2019</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># PREDICTOR: Y</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">sst_region</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">predictand</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">PREDICTAND_NAME</span><span class="p">,</span> <span class="n">DATASET_DIR</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;CHL&quot;</span><span class="p">)</span>
<span class="n">chl_region</span> <span class="o">=</span> <span class="n">Region</span><span class="p">(</span>
    <span class="n">lat0</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">latf</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span>
    <span class="n">lon0</span><span class="o">=-</span><span class="mf">5.3</span><span class="p">,</span> <span class="n">lonf</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">month0</span><span class="o">=</span><span class="n">Month</span><span class="o">.</span><span class="n">MAR</span><span class="p">,</span> <span class="n">monthf</span><span class="o">=</span><span class="n">Month</span><span class="o">.</span><span class="n">APR</span><span class="p">,</span>
    <span class="n">year0</span><span class="o">=</span><span class="mi">1998</span><span class="p">,</span> <span class="n">yearf</span><span class="o">=</span><span class="mi">2020</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># PRECITAND: Z</span>
<span class="n">predictand</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">chl_region</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;spy4cast.dataset.Dataset at 0x7f9ec9321640&gt;
</pre></div></div>
</div>
<p>Climatology and anomaly plots can be created easily with <code class="docutils literal notranslate"><span class="pre">meteo.Clim</span></code> and <code class="docutils literal notranslate"><span class="pre">meteo.Anom</span></code> as well as time series</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">spy4cast.meteo</span><span class="w"> </span><span class="kn">import</span> <span class="n">Clim</span>

<span class="n">Clim</span><span class="p">(</span><span class="n">predictand</span><span class="p">,</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((&lt;Figure size 1000x400 with 2 Axes&gt;,), (&lt;GeoAxesSubplot:&gt;,))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_50_1.png" src="../_images/manual_Tutorial_50_1.png" />
</div>
</div>
</section>
<section id="id2">
<h3>2. Preprocessing<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>Preprocessing only takes one line, as everything we did before is included.</p>
<p>It also performs a Butterwirth filter if you provide the <code class="docutils literal notranslate"><span class="pre">period</span></code> and <code class="docutils literal notranslate"><span class="pre">order</span></code> keyword arguments. To do so it uses <code class="docutils literal notranslate"><span class="pre">scipy.signal.butter</span></code> along with <code class="docutils literal notranslate"><span class="pre">scipy.signal.filtfilt</span></code> functions along the time axis</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictor_preprocessed</span> <span class="o">=</span> <span class="n">Preprocess</span><span class="p">(</span><span class="n">predictor</span><span class="p">)</span>
<span class="n">predictand_preprocessed</span> <span class="o">=</span> <span class="n">Preprocess</span><span class="p">(</span><span class="n">predictand</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[INFO] Preprocessing data for variable sst took: 0.031 seconds
[INFO] Preprocessing data for variable CHL took: 0.017 seconds
</pre></div></div>
</div>
<p>To visalize easily the region of both variables we can use <code class="docutils literal notranslate"><span class="pre">.plot</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictor_preprocessed</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">selected_year</span><span class="o">=</span><span class="mi">1999</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">predictand_preprocessed</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">selected_year</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((&lt;Figure size 800x400 with 2 Axes&gt;,),
 (&lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;Year 2000&#39;}&gt;,))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_54_1.png" src="../_images/manual_Tutorial_54_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_54_2.png" src="../_images/manual_Tutorial_54_2.png" />
</div>
</div>
<p>To save the calculated matrices, spy4cast includes a convenient method in case there is an intention to share the results</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATA_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;step-by-step-tutorial/data/&#39;</span>
<span class="n">PREDICTOR_PREPROCESSED_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;predictor_&#39;</span>
<span class="n">PREDICTAND_PREPROCESSED_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;predictand_&#39;</span>

<span class="n">predictor_preprocessed</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">PREDICTOR_PREPROCESSED_PREFIX</span><span class="p">,</span> <span class="n">DATA_FOLDER</span><span class="p">)</span>
<span class="n">predictand_preprocessed</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">PREDICTAND_PREPROCESSED_PREFIX</span><span class="p">,</span> <span class="n">DATA_FOLDER</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[INFO] Saving Preprocess data in `step-by-step-tutorial/data/predictor_*.npy`
[INFO] Saving Preprocess data in `step-by-step-tutorial/data/predictand_*.npy`
</pre></div></div>
</div>
<p>They will be saved in <code class="docutils literal notranslate"><span class="pre">.npy</span></code> format. Eventhough this format is not the best it promotes compatibility and it is flexible so that it can be used with any other tools. In the future, if there is a demand from the users, it will be easy to move to any format it is suggested. To load the different matrices that are saved only the <code class="docutils literal notranslate"><span class="pre">np.load</span></code> method is needed.</p>
<p>However, spy4cast has a more convenient function to get the same object you have saved from the previous call</p>
<p>This is useful to write code in the following manner:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Once these have been run we set to False and the program is faster</span>
<span class="n">RUN_PREPROCESS_Y</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">RUN_PREPROCESS_Z</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">if</span> <span class="n">RUN_PREPROCESS_Y</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">Preprocess</span><span class="p">(</span><span class="n">sst</span><span class="p">)</span>
    <span class="n">y</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;y_&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">Preprocess</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;y_&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">RUN_PREPROCESS_Z</span><span class="p">:</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">Preprocess</span><span class="p">(</span><span class="n">chl</span><span class="p">)</span>
    <span class="n">z</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;z_&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">Preprocess</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;z_&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>

<span class="n">mca</span> <span class="o">=</span> <span class="n">MCA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span>
</pre></div>
</div>
<p>### 3. MCA</p>
<p>MCA is built into spy4cast. It performs the exact same methodology as before and returns a variable contaning all the matrices as before</p>
<p>This is very convenient for user experience as all the date is stored together</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nm</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span>

<span class="n">mca</span> <span class="o">=</span> <span class="n">MCA</span><span class="p">(</span><span class="n">predictor_preprocessed</span><span class="p">,</span> <span class="n">predictand_preprocessed</span><span class="p">,</span> <span class="n">nm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[INFO] Applying MCA
    Shapes: Z(24750, 23)
            Y(1100, 23)
    Regions: Z MA (36.00ºN, 37.00ºN - 5.30ºW, 2.00ºW)
            Y AS (5.00ºN, 25.00ºN - 75.00ºW, 20.00ºW)
       Took: 4.556 seconds
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mca</span><span class="o">.</span><span class="n">var_names</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;psi&#39;,
 &#39;RUY&#39;,
 &#39;RUY_sig&#39;,
 &#39;SUY&#39;,
 &#39;SUY_sig&#39;,
 &#39;RUZ&#39;,
 &#39;RUZ_sig&#39;,
 &#39;SUZ&#39;,
 &#39;SUZ_sig&#39;,
 &#39;pvalruz&#39;,
 &#39;pvalruy&#39;,
 &#39;Us&#39;,
 &#39;Vs&#39;,
 &#39;scf&#39;,
 &#39;alpha&#39;,
 &#39;nm&#39;)
</pre></div></div>
</div>
<p>As in Preprocess, there is a method to save the data into <code class="docutils literal notranslate"><span class="pre">.npy</span></code> format. This is useful when the user needs to change the plots and wants to use the results without running the methodology again</p>
<p>As in Preprocess, it can be used the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">RUN_PREPROCESS_MCA</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">if</span> <span class="n">RUN_PREPROCESS_Y</span><span class="p">:</span>
    <span class="n">mca</span> <span class="o">=</span> <span class="n">MCA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">nm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="n">mca</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;mca_&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">mca</span> <span class="o">=</span> <span class="n">MCA</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;mca_&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">dsy</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">dsz</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MCA_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;mca_&#39;</span>

<span class="n">mca</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">MCA_PREFIX</span><span class="p">,</span> <span class="n">DATA_FOLDER</span><span class="p">)</span>
<span class="c1"># mca = MCA.load(MCA_PREFIX, DATA_FOLDER, dsy=predictor_preprocessed, dsz=predictand_preprocessed)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[INFO] Saving MCA data in `step-by-step-tutorial/data/mca_*.npy`
</pre></div></div>
</div>
</section>
<section id="id3">
<h3>4. Plot MCA<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Plotting takes one command also and it is very easy to save the plots and to change the visulization</p>
<p>These plots must be used as a quick-diagnosis tool and not as a final result. We encourage users to write their own plot functions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PLOTS_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;step-by-step-tutorial/plots&#39;</span>

<span class="n">MCA_PLOT_NAME</span> <span class="o">=</span> <span class="s1">&#39;mca.png&#39;</span>

<span class="n">mca</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">save_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">MCA_PLOT_NAME</span><span class="p">,</span>
         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
         <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
         <span class="n">folder</span><span class="o">=</span><span class="n">PLOTS_FOLDER</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[INFO] Saving plot with path step-by-step-tutorial/plots/mca.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((&lt;Figure size 1400x800 with 11 Axes&gt;,),
 (&lt;AxesSubplot:title={&#39;center&#39;:&#39;Us Vs mode 1&#39;}&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;Us Vs mode 2&#39;}&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;Us Vs mode 3&#39;}&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;RUY mode 1. SCF=47.1%&#39;}&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;RUY mode 2. SCF=12.0%&#39;}&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;RUY mode 3. SCF=9.3%&#39;}&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;RUZ mode 1. SCF=47.1%&#39;}&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;RUZ mode 2. SCF=12.0%&#39;}&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;RUZ mode 3. SCF=9.3%&#39;}&gt;))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_64_2.png" src="../_images/manual_Tutorial_64_2.png" />
</div>
</div>
<p>### 5. Crossvalidation</p>
<p>Crossvalidation is the same as MCA but leaving one year out of the analysis. The code for xarray-MCA can be modified to run crossvalidation. Here we show how it is run with spy4cast. It has the same <code class="docutils literal notranslate"><span class="pre">.save</span></code>, <code class="docutils literal notranslate"><span class="pre">.load</span></code> and <code class="docutils literal notranslate"><span class="pre">.plot</span></code> functions as <code class="docutils literal notranslate"><span class="pre">MCA</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cross</span> <span class="o">=</span> <span class="n">Crossvalidation</span><span class="p">(</span><span class="n">predictor_preprocessed</span><span class="p">,</span> <span class="n">predictand_preprocessed</span><span class="p">,</span> <span class="n">nm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[INFO] Applying Crossvalidation
    Shapes: Z(24750, 23)
            Y(1100, 23)
    Regions: Z MA (36.00ºN, 37.00ºN - 5.30ºW, 2.00ºW)
            Y AS (5.00ºN, 25.00ºN - 75.00ºW, 20.00ºW)
        year: 1 of 23
        year: 2 of 23
        year: 3 of 23
        year: 4 of 23
        year: 5 of 23
        year: 6 of 23
        year: 7 of 23
        year: 8 of 23
        year: 9 of 23
        year: 10 of 23
        year: 11 of 23
        year: 12 of 23
        year: 13 of 23
        year: 14 of 23
        year: 15 of 23
        year: 16 of 23
        year: 17 of 23
        year: 18 of 23
        year: 19 of 23
        year: 20 of 23
        year: 21 of 23
        year: 22 of 23
        year: 23 of 23

        Took: 150.828 seconds
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CROSS_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;cross_&#39;</span>

<span class="n">cross</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">CROSS_PREFIX</span><span class="p">,</span> <span class="n">DATA_FOLDER</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[INFO] Saving Crossvalidation data in `step-by-step-tutorial/data/cross_*.npy`
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cross = Crossvalidation.load(CROSS_PREFIX, DATA_FOLDER, dsy=predictor_preprocessed, dsz=predictand_preprocessed)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CROSS_PLOT_NAME</span> <span class="o">=</span> <span class="s1">&#39;cross.png&#39;</span>

<span class="n">cross</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">save_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="n">PLOTS_FOLDER</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">CROSS_PLOT_NAME</span><span class="p">,</span> <span class="n">map_levels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">rmse_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[INFO] Saving plot with path step-by-step-tutorial/plots/cross.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((&lt;Figure size 1600x800 with 6 Axes&gt;,),
 (&lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;ACC map&#39;}&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;ACC time series&#39;}&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;RMSE map&#39;}&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;RMSE time series&#39;}&gt;))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_69_2.png" src="../_images/manual_Tutorial_69_2.png" />
</div>
</div>
<p>Crossvalidation provides a different version of diagnosis plot with <code class="docutils literal notranslate"><span class="pre">version=2</span></code> by which you also need to provide <code class="docutils literal notranslate"><span class="pre">mca=mca</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cross</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">save_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="n">PLOTS_FOLDER</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">CROSS_PLOT_NAME</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mca</span><span class="o">=</span><span class="n">mca</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[INFO] Saving plot with path step-by-step-tutorial/plots/cross.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((&lt;Figure size 2400x850 with 16 Axes&gt;,),
 (&lt;AxesSubplot:title={&#39;center&#39;:&#39;Mode 1, |ruv|=0.50 p=0.985&#39;}, xlabel=&#39;Years&#39;, ylabel=&#39;nº std&#39;&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;Mode 1, |ruv|=0.50 , scf=47.10%&#39;}, xlabel=&#39;Years&#39;, ylabel=&#39;|ruv|&#39;&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;ACC 1 modes&#39;}&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;Skill (bars), \n MSESS (lines)&#39;}&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;Mode 2, |ruv|=0.70 p=1.000&#39;}, xlabel=&#39;Years&#39;&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;Mode 2, |ruv|=0.70 , scf=11.96%&#39;}, xlabel=&#39;Years&#39;&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;ACC 2 modes&#39;}&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;ACC [1 2]) - [1]&#39;}&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;Mode 3, |ruv|=0.49 p=0.982&#39;}, xlabel=&#39;Years&#39;&gt;,
  &lt;AxesSubplot:title={&#39;center&#39;:&#39;Mode 3, |ruv|=0.49 , scf=9.26%&#39;}, xlabel=&#39;Years&#39;&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;ACC 3 modes&#39;}&gt;,
  &lt;GeoAxesSubplot:title={&#39;center&#39;:&#39;ACC [1 2 3]) - [1 2]&#39;}&gt;))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/manual_Tutorial_71_2.png" src="../_images/manual_Tutorial_71_2.png" />
</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../example.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Usage Example</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Pacific_Impact_Sahelian_Rainfall.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Jupyter Notebook Version for calculating Pacific Impact on Sahelian Rain Fall</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Pablo Duran
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Step by step Tutorial</a><ul>
<li><a class="reference internal" href="#Using-xarray">Using xarray</a><ul>
<li><a class="reference internal" href="#1.-Configuration">1. Configuration</a></li>
<li><a class="reference internal" href="#2.-Preprocessing">2. Preprocessing</a></li>
<li><a class="reference internal" href="#3.-Perform-MCA">3. Perform MCA</a></li>
<li><a class="reference internal" href="#4.-Plot-MCA">4. Plot MCA</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Using-Spy4Cast">Using Spy4Cast</a><ul>
<li><a class="reference internal" href="#id1">1. Configuration</a></li>
<li><a class="reference internal" href="#id2">2. Preprocessing</a></li>
<li><a class="reference internal" href="#id3">4. Plot MCA</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=81d74243"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>